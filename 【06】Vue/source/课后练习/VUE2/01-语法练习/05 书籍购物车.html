<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        table {
            border: 1px solid #e9e9e9;
            border-collapse: collapse;
            border-spacing: 0;
        }

        th, td {
            padding: 8px 16px;
            border: 1px solid #e9e9e9;
            text-align: left;
        }

        th {
            background-color: #f7f7f7;
            color: #5c6b77;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- 当books数组长度为零即代表列表全部被移除,显示v-else购物车为空 -->
        <table v-if="books.length">
            <thead>
            <tr>
                <th></th>
                <th>书籍名称</th>
                <th>出版日期</th>
                <th>价格</th>
                <th>购买数量</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
                <!-- 通过v-for遍历获取每个数组元素对象为一行 -->
                <tr v-for="(item,index) in books">
                    <td>{{item.id}}</td>
                    <td>{{item.name}}</td>
                    <td>{{item.date}}</td>
                    <!-- 价格前面要+￥ 并且保留两位小数 -->
                    <td>{{getFinalPrice(index)}}</td>
                    <td>
                        <!-- 通过v-bind绑定按钮禁用点击属性:当数量小于1时触发 -->
                        <button @click="der(index)" :disabled="item.count<=1">-</button>
                        {{item.count}}
                        <button @click="inc(index)">+</button>
                    </td>
                    <td><button @click="remove">移除</button></td>
                </tr>
            </tbody>
        </table>
        <h4 v-else>当前购物车为空</h4>
        <h4>当前总价格: {{totalPrice}}</h4>
    </div>

    <script src="vue.js"></script>
    <script>
        const app = new Vue({
            el:"#app",
            data:{
                books: [
                    {
                      id: 1,
                      name: '《算法导论》',
                      date: '2006-9',
                      price: 85.00,
                      count: 1
                    },
                    {
                      id: 2,
                      name: '《UNIX编程艺术》',
                      date: '2006-2',
                      price: 59.00,
                      count: 1
                    },
                    {
                      id: 3,
                      name: '《编程珠玑》',
                      date: '2008-10',
                      price: 39.00,
                      count: 1
                    },
                    {
                      id: 4,
                      name: '《代码大全》',
                      date: '2006-3',
                      price: 128.00,
                      count: 1
                    },
                ]
            },
            methods:{
                der(index){
                    this.books[index].count--;
                },
                inc(index){
                    this.books[index].count++;
                },
                remove(index){
                    //每次移除删除一行tr,即删除一个数组元素
                    this.books.splice(index,1);
                },
                getFinalPrice(index){
                    let finalPrice = 0;
                    finalPrice = "￥" + this.books[index].price.toFixed(2)
                    return finalPrice;
                }
            },
            computed:{
                totalPrice(){
                    let totalPrice = 0;
                    //for of遍历直接获取到对象的元素
                    for(item of this.books){
                        totalPrice += item.price * item.count;
                    }
                    return totalPrice;
                }
            }
        })
    </script>
</body>
</html>